<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      padding: 4rem;
    }
    table {
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th {
      background-color: #ddd;
      font-weight: bold;
      text-align: left;
    }
  </style>
  <script>
    function calculateDifference() {
      var date1 = new Date(document.getElementById('date1').value);
      var time1 = document.getElementById('time1').value.split(':');
      date1.setHours(parseInt(time1[0]), parseInt(time1[1]));

      var date2 = new Date(document.getElementById('date2').value);
      var time2 = document.getElementById('time2').value.split(':');
      date2.setHours(parseInt(time2[0]), parseInt(time2[1]));

      var difference = Math.abs(date2 - date1) / (1000 * 60 * 60);

      var table = document.getElementById('result-table');
      var rows = Array.from(table.getElementsByTagName('tr')).slice(1, -1); // Ignore header and total rows
      
      // Find or create the row for this week
      var currentWeekRow;
      var currentWeekStart = getWeekStart(date1);
      rows.forEach(function(row) {
        var rowDate = new Date(row.cells[0].innerHTML);
        var rowWeekStart = getWeekStart(rowDate);
        if (rowWeekStart.getTime() === currentWeekStart.getTime()) {
          currentWeekRow = row;
        }
      });
      if (!currentWeekRow) {
        currentWeekRow = table.insertRow(-1);
        var cell1 = currentWeekRow.insertCell(0);
        var cell2 = currentWeekRow.insertCell(1);
        var cell3 = currentWeekRow.insertCell(2);
        var cell4 = currentWeekRow.insertCell(3);
        cell1.innerHTML = date1.toLocaleString('fr-FR', { dateStyle: 'short' });
        cell2.innerHTML = time1.join(':');
        cell3.innerHTML = time2.join(':');
        cell4.className = 'week-total';
      }

      // Update or append hours for this week
      var currentWeekTotalCell = currentWeekRow.cells[3];
      var currentWeekTotalHours = parseFloat(currentWeekTotalCell.innerHTML) || 0;
      currentWeekTotalHours += difference;
      currentWeekTotalCell.innerHTML = currentWeekTotalHours.toFixed(2);

      // Update the total row
      var totalRow = table.rows[table.rows.length - 1];
      var totalHours = parseFloat(totalRow.cells[3].innerHTML) || 0;
      totalHours += difference;
      totalRow.cells[3].innerHTML = totalHours.toFixed(2);
    }

    function getWeekStart(date) {
      var start = new Date(date);
      start.setHours(0, 0, 0, 0);
      start.setDate(date.getDate() - date.getDay()); // Start of the week (Sunday)
      return start;
    }
  </script>
</head>
<body class="bg-gray-100">
  <div class="max-w-lg mx-auto bg-white p-8 border border-gray-300">
    <h1 class="text-2xl font-bold mb-4">Transports Lebranchu et fils</h1>
    <div class="mb-4">
      <label for="date1" class="font-bold">First Date:</label>
      <input type="date" id="date1" class="border border-gray-300 py-2 px-4">
      <input type="time" id="time1" class="border border-gray-300 py-2 px-4">
    </div>
    <div class="mb-4">
      <label for="date2" class="font-bold">Second Date:</label>
      <input type="date" id="date2" class="border border-gray-300 py-2 px-4">
      <input type="time" id="time2" class="border border-gray-300 py-2 px-4">
    </div>
    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onclick="calculateDifference()">Calculate</button>
    <table id="result-table" class="mt-4">
      <tr>
        <th>Date</th>
        <th>Heure début</th>
        <th>Heures fin</th>
        <th>Heures travaillées</th>
      </tr>
      <tr>
        <td>Total hours per week:</td>
        <td></td>
        <td></td>
        <td class="total-hours"></td>
      </tr>
    </table>
  </div>
</body>
</html>
